set(MODULES_INI_FILE "${CMAKE_BINARY_DIR}/modules.ini" CACHE FILEPATH "Path of generated modules index file")
file(WRITE "${MODULES_INI_FILE}" "; Generated File - DO NOT EDIT\n")

foreach (SS4S_MODULE_NAME ${SS4S_MODULE_NAMES})
    get_target_property(SS4S_MODULE_OUTPUT ${SS4S_MODULE_NAME} LIBRARY_OUTPUT_NAME)
    get_target_property(SS4S_MODULE_DISPLAY_NAME ${SS4S_MODULE_NAME} SS4S_MODULE_DISPLAY_NAME)
    get_target_property(SS4S_MODULE_FOR_AUDIO ${SS4S_MODULE_NAME} SS4S_MODULE_FOR_AUDIO)
    get_target_property(SS4S_MODULE_FOR_VIDEO ${SS4S_MODULE_NAME} SS4S_MODULE_FOR_VIDEO)
    get_target_property(SS4S_MODULE_CONFLICT ${SS4S_MODULE_NAME} SS4S_MODULE_CONFLICT)
    set(SS4S_MODULE_FILENAME "${CMAKE_SHARED_LIBRARY_PREFIX}${SS4S_MODULE_OUTPUT}${CMAKE_SHARED_LIBRARY_SUFFIX}")
    file(APPEND "${MODULES_INI_FILE}" "[${SS4S_MODULE_FILENAME}]\n")
    if (SS4S_MODULE_DISPLAY_NAME)
        file(APPEND "${MODULES_INI_FILE}" "name = ${SS4S_MODULE_DISPLAY_NAME}\n")
    endif ()
    if (SS4S_MODULE_FOR_AUDIO)
        file(APPEND "${MODULES_INI_FILE}" "audio = true\n")
    endif ()
    if (SS4S_MODULE_FOR_VIDEO)
        file(APPEND "${MODULES_INI_FILE}" "video = true\n")
    endif ()
    if (SS4S_MODULE_CONFLICT)
        file(APPEND "${MODULES_INI_FILE}" "conflict = ${SS4S_MODULE_CONFLICT}\n")
    endif ()
    file(APPEND "${MODULES_INI_FILE}" "\n")
endforeach ()

install(FILES ${MODULES_INI_FILE} DESTINATION ${CMAKE_INSTALL_DATAROOTDIR})